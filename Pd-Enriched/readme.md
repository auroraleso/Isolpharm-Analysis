<img width="500" src="docs/logo.svg">

ROOT4CoMPASS is a simple code which can be used for splitting spectra acquired with CAEN CoMPASS DAQ software.

The code is based on the RO^

# Usage

At each new "run" CoMPASS creates a ROOT file containing a `TTree` named `Data_R` in wich different branches are stored. Each one of these contains an event-related quantity.

The event can be modeled with this struct:

````c++
struct CompassEvent
{
	UShort_t channel;
	ULong_t  timestamp;
	UShort_t board;
	UShort_t energy;
	Int_t flags;
};
````

The code can be executed in two modes: Scanning and Single Spectra.

## Scanning Mode

In Scanning mode the code takes as argument a time window in seconds (`-S` option) and two CoMPASS ROOT files: one with actual measurements (`-f` option) and the other with a background run (`-b` option).
The user can also supply a `.info` file (usually generated by CoMPASS) in order to display run file informations (not necessary).

The user should also provide calibration parameters `-m` and `-q`.

Providing these, the code create an output ROOT file containing a certain number of energy spectra of duration `time-window`.

All spectra inside the output file are energy calibrated, background-subtracted and dead-time corrected.

### Example

If one is intrested in producing a file with spectra of one hour duration:

````bash
Analysis -S 3600 -f measurements_file.root -b background_file.root -i measurements_file.info -m <p1> -q <p0>
````

## Single Spectra Extraction

The Single Spectra Extraction mode accept two dates in the following format: Year/Month/Day hours:minutes:seconds
and produces a file with all events between these two dates.


### Example

````bash
Analysis -s "2021/02/09 16:00:00" -e "2021/02/09 17:00:00" -f measurements_file.root -b background_file.root -i measurements_file.info
````
